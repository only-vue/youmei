"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.HOST=void 0;var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),_es6Promise=require("../vendors/es6-promise.min"),_es6Promise2=_interopRequireDefault(_es6Promise),HOST=exports.HOST="https://openapi.faceid.com",WxRequest=function(){function e(t){if(_classCallCheck(this,e),!t||!t.options||!t.options.url)throw new Error("\u8bf7\u6c42\u53c2\u6570\u683c\u5f0f\u6709\u8bef\uff01");var n=HOST,s="/lite/v1";t.options&&t.options.url_prefix&&(s=t.options.url_prefix),this.defaultOptions=Object.assign({method:"GET",data:{},header:{"content-type":"application/json"}},t.options,{url:n+s+t.options.url}),this.beforeSend=t&&t.beforeSend||function(){},this.afterResponse=t&&t.afterResponse||function(){}}return _createClass(e,[{key:"post",value:function(){return this.defaultOptions=Object.assign(this.defaultOptions,{method:"POST"}),this.request()}},{key:"get",value:function(){return this.defaultOptions=Object.assign(this.defaultOptions,{method:"GET"}),this.request()}},{key:"request",value:function(){var e=this.defaultOptions,t=this;return this.beforeSend(),new _es6Promise2.default(function(n,s){wx.request(Object.assign({},e,{success:function(e){t.success(e).then(function(e){return n(e)}).catch(function(e){return s(e)})},fail:function(e){t.fail(e).then(function(e){return s(e)})},complete:function(e){t.complete(e)}}))})}},{key:"upload",value:function(){var e=Object.assign(this.defaultOptions,{header:{"Content-Type":"multipart/form-data"},formData:this.defaultOptions.data}),t=this;return this.beforeSend(),new _es6Promise2.default(function(n,s){wx.uploadFile(Object.assign({},e,{success:function(e){t.success(e).then(function(e){return n(JSON.parse(e))}).catch(function(e){return s(e)})},fail:function(e){t.fail(e).then(function(e){return s(e)})},complete:function(e){t.complete(e)}}))})}},{key:"success",value:function(e){return new _es6Promise2.default(function(t,n){if(200===e.statusCode)t(e.data);else{var s=void 0,o=0;switch(e.statusCode){case 0:s="TIME_OUT";break;case 413:s="TOO_LARGE";break;case 403:o=-1,s="PROCESS_ERROR";break;case 400:s="PROCESS_ERROR";break;case 429:s="LIMIT_EXCEEDED";break;default:s="ERROR_UNKOWN"}n({result_code:s,code:o})}})}},{key:"fail",value:function(e){return new _es6Promise2.default(function(t){var n="ERROR_UNKOWN";if(e&&e.error)switch(e.error){case"uploadFile:fail Error: ESOCKETTIMEDOUT":case"uploadFile:fail \u8bf7\u6c42\u8d85\u65f6\u3002":case"uploadFile:fail \u7f51\u7edc\u8fde\u63a5\u5df2\u4e2d\u65ad\u3002":n="LIMIT_EXCEEDED"}t({result_code:n,code:0})})}},{key:"complete",value:function(){this.afterResponse()}}]),e}();exports.default=WxRequest;