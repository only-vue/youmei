"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}var _request=require("../_utils/request"),request=_interopRequireWildcard(_request),_actions=require("../../tools/actions"),Action=_interopRequireWildcard(_actions),_interface=require("../../tools/interface"),_interface2=_interopRequireDefault(_interface),_const=require("../_utils/const");Component({properties:{token:{type:String,value:null}},data:{step:null,STEP_TO:_const.STEP_TO,verify_type:null},attached:function(){var e=this;wx.getSystemInfo({success:function(e){wx.setStorageSync("landing_bg_width",.7*e.screenWidth),wx.setStorageSync("landing_ocr_width",.87*e.screenWidth),wx.setStorageSync("video_bg_width",.7*e.screenWidth)}}),_interface2.default.setCompleteHandler(function(t){e.triggerEvent("onFinish",t)})},ready:function(){this.getConfig()},methods:{getConfig:function(){var e=this,t=void 0,i=void 0;request.getUserInfo(e.data.token).then(function(n){t=_const.STEP_TO.landing,i=n.group&&0!==n.group?2===n.group?_const.VERIFY_TYPES["input-idcard"]:0===n.idcard_side?_const.VERIFY_TYPES.all:_const.VERIFY_TYPES.ocridcard:_const.VERIFY_TYPES["liveness-video"];var r=n.idcard_uneditable_field?n.idcard_uneditable_field:[];e.setData({verify_type:i,step:t,code:n.code,name_editable:-1===r.indexOf("idcard_name"),number_editable:-1===r.indexOf("idcard_number"),valid_date_editable:-1===r.indexOf("idcard_valid_date"),issued_by_editable:-1===r.indexOf("idcard_issued_by")})},function(){Action.ExitLite({token:e.data.token,status:"tokenError"})})},onNextStep:function(e){var t=e.detail.nextStep,i=Object.assign({},e.detail,{step:t});delete i.nextStep,i.error_code||(i=Object.assign(i,{error_code:null})),this.setData(i)}}});